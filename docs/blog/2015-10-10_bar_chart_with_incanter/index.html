<!DOCTYPE html>
<html><head><title>Software Bears</title><link href="//fonts.googleapis.com/css?family=Montserrat+Alternates:400,700" rel="stylesheet" type="text/css"><link href="/css/normalize.min.css" rel="stylesheet" type="text/css"><link href="/css/main.css" rel="stylesheet" type="text/css"><link href="/css/highlight.min.css" rel="stylesheet" type="text/css"><script src="/js/main.js" type="text/javascript"></script><script src="/js/highlight.pack.js" type="text/javascript"></script><script type="text/javascript">//<![CDATA[
hljs.configure({languages: []}); hljs.initHighlightingOnLoad();
//]]></script><link href="/apple-touch-icon-57x57.png" rel="apple-touch-icon" sizes="57x57"><link href="/apple-touch-icon-60x60.png" rel="apple-touch-icon" sizes="60x60"><link href="/apple-touch-icon-72x72.png" rel="apple-touch-icon" sizes="72x72"><link href="/apple-touch-icon-76x76.png" rel="apple-touch-icon" sizes="76x76"><link href="/apple-touch-icon-114x114.png" rel="apple-touch-icon" sizes="114x114"><link href="/apple-touch-icon-120x120.png" rel="apple-touch-icon" sizes="120x120"><link href="/favicon-32x32.png" rel="icon" sizes="32x32" type="image/png"><link href="/favicon-96x96.png" rel="icon" sizes="96x96" type="image/png"><link href="/favicon-16x16.png" rel="icon" sizes="16x16" type="image/png"><link href="/manifest.json" rel="manifest"><meta content="#000000" name="msapplication-TileColor"><meta content="#ffffff" name="theme-color"></head><body><header><h1 class="name"><span>Software</span><span>Bears</span></h1></header><nav><div id="show-nav"></div><ul><li><a href="/">Home</a></li><li><a href="/portfolio">Portfolio</a></li><li><a href="/blog">Blog</a></li><li><a href="/contact">Contact us</a></li></ul></nav><div class="intro full black"><p class="middle"><span class="name"><span>Software</span><span>Bears</span>.com</span></p></div><main class="blog"><section class="white" id="blog-item"><h2>Making a bar chart of county names with Incanter</h2><p class="metadata">By <span class="author">Corey Beres</span> on <span class="time">Sat, Oct 10, 2015</span></p><p><img src="/img/county&#95;chart&#95;incanter.png" alt="Chart of most popular county names versus frequency" title="Chart of most popular county names versus frequency" /></p><p>In our last installment, we used <a href='http://jsoup.org/'>jsoup</a> and <a href='http://clojure.org/'>Clojure</a> to parse a list of county names. As it turns out, we can thank George Washington for giving birth to both the USA <em>and</em> the most frequent county name: Washington County!</p><p>As promised, our <em>county counter</em> now automatically builds a bar chart (or histogram) of the most frequent county names in America. For this I used <a href='http://incanter.org/'>Incanter</a>, "a Clojure-based, <a href='http://www.r-project.org/'>R</a>-like platform for statistical computing and graphics." Above, you can see the final result.</p><p><em>You can find all the code in this post on <a href='https://github.com/cberes/counties'>GitHub</a>.</em></p><h3>Finding the bar-chart library</h3><p>Before I started working on this little project, I had no idea how I would use Clojure to generate a bar chart. Obviously I would use a third-party library for the job, but I didn't even know of any. I search for "clojure histogram." This led me to <a href='https://github.com/bigmlcom/histogram'>histogram by bigmlcom</a>, which was not what I was looking for.</p><p>You'll also find the <a href='https://clojuredocs.org/clojure.core/frequencies'>frequencies</a> function in the search results, but I already know about this function: I want to visualize its output.</p><p>Later on in the results was Incanter. I saw their <code>histogram</code> function, but that seems suited for raw numerical data. But there is also the <a href='http://liebke.github.io/incanter/charts-api.html#incanter.charts/bar-chart'>bar-chart</a> function, which accepts two parameters: a list of categories and a list of corresponding values. Sounds like we found the man for the job.</p><h3>Plotting the results</h3><p>Armed with a function and data, we're ready to make a chart! Assuming <code>d</code> is our data from the <code>frequencies</code> function and <code>n</code> is the number of results to plot, this is how we can view the bar chart:</p><pre><code class="clojure">&#40;let &#91;data &#40;take n&#40;reverse &#40;sort-by val d&#41;&#41;&#41;&#93;
  &#40;view &#40;bar-chart &#40;keys data&#41; &#40;vals data&#41;&#41;&#41;
</code></pre><p>We can turn this into a function that also saves the bar chart to a file:</p><pre><code class="clojure">&#40;defn to-histogram &#91;d n filename&#93;
  &#40;let &#91;data &#40;take n &#40;reverse &#40;sort-by val d&#41;&#41;&#41;
        plot &#40;bar-chart &#40;keys data&#41; &#40;vals data&#41;&#41;&#93;
    &#40;save plot filename&#41;
    &#40;view plot&#41;&#41;&#41;
</code></pre><p>After modifying the <code>main</code> function to use this function, we can run our program with <code>lein run</code> to make a chart.</p><p><img src="/img/county&#95;chart&#95;first.png" alt="Chart of most popular county names versus frequency" title="Chart of most popular county names versus frequency" /></p><p>Uh, so, there are some problems. We can't see any of the county names and the labels are useless. Let's take a look at the <code>bar-chart</code> options: title, x-label, y-label, series-label, legend, vertical, and group-by. The title and label options clearly seem useful. And, hmm, maybe vertical will make more room for the county names?</p><p>Now our call to <code>bar-chart</code> looks as follows with the new options. We can also add <code>:height</code> and <code>:width</code> options to the <code>save</code> function.</p><pre><code class="clojure">&#40;bar-chart &#40;keys data&#41; &#40;vals data&#41;
  :title &quot;Most popular county names&quot;
  :x-label &quot;counties&quot;
  :y-label &quot;frequency&quot;
  :vertical false&#41;
</code></pre><p>There we have it! That's how the chart at the beginning of the post was made. Now we can actually see the county names. Also, the labels help to explain what's in the chart.</p><h3>Get the code</h3><p>The complete code for this post is on <a href='https://github.com/cberes/counties'>GitHub</a>!</p></section></main><footer class="black"><h2>Want to see more? View our <a href="/portfolio">portfolio</a>, read our <a href="/blog">blog</a>, or check out our GitHub <a href="https://github.com/cberes">repos</a>.</h2><p>Corey Beres<br>Freelance software engineer<br>SOA, web services, Android apps &amp; SDKs,<br>web applications, and database design</p><p>Email: <a href="mailto:hello@softwarebears.com">hello@softwarebears.com</a><br>Tel: (716) 222 0088<br>Find us on <a href="https://github.com/cberes">GitHub</a>, <a href="https://instagram.com/softwarebears">Instagram</a>, &amp <a href="https://twitter.com/softwarebears">Twitter</a><br>&copy; 2015-2017 <span class="name"><span>Software</span><span>Bears</span></span></p><div class="clear"></div></footer></body></html>